<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title><span style="color:blue">Zoom</span><span style="color:orange">Unta</span></title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f0f2f5;
}

/* HEADER */
header {
    background: #1877f2;
    color: white;
    padding: 12px;
    font-size: 22px;
    font-weight: bold;
    text-align: center;
}

/* PROFILE SECTION */
.profile-box {
    background: white;
    padding: 12px;
    margin: 10px;
    border-radius: 8px;
    text-align: center;
}
.profile-box input {
    width: 80%;
    padding: 8px;
    margin-bottom: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
}
.profile-box input[type="file"] {
    width: 80%;
}
.profile-box button {
    background: #1877f2;
    color: white;
    border: none;
    padding: 10px;
    width: 50%;
    border-radius: 6px;
    font-size: 16px;
}

/* POST BOX */
.post-box {
    background: white;
    padding: 12px;
    margin: 10px;
    border-radius: 8px;
}
.post-box textarea {
    width: 100%;
    margin-bottom: 8px;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
}
.post-box input[type="file"] {
    margin-bottom: 8px;
}
.post-box button {
    background: #1877f2;
    color: white;
    border: none;
    padding: 10px;
    width: 100%;
    border-radius: 6px;
    font-size: 16px;
}

/* FEED */
.feed {
    margin: 10px;
}
.post {
    background: white;
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 10px;
}
.post img {
    max-width: 100%;
    margin-top: 8px;
    border-radius: 6px;
}
.post h4 {
    margin: 0;
}
.post p {
    margin-top: 6px;
}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-storage.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBQXx4AgjmjFhWTQEGZFJ8gyjhrGG36T04",
    authDomain: "zoomunta.firebaseapp.com",
    projectId: "zoomunta",
    databaseURL: "https://zoomunta-default-rtdb.firebaseio.com",
    storageBucket: "zoomunta.appspot.com",
    messagingSenderId: "490604667032",
    appId: "1:490604667032:web:088173f78346086d14f0ed"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
  const storage = firebase.storage();

  let currentProfile = {name: "", photoUrl: ""};

  function createProfile() {
    const name = document.getElementById("profileName").value.trim();
    const photo = document.getElementById("profilePic").files[0];

    if (!name) { alert("Enter your name"); return; }

    if (photo) {
      const storageRef = storage.ref('profiles/' + photo.name);
      storageRef.put(photo).then(snapshot => {
        snapshot.ref.getDownloadURL().then(url => {
          currentProfile = {name: name, photoUrl: url};
          alert("Profile created!");
          document.getElementById("profileBox").style.display = "none";
          document.getElementById("postBox").style.display = "block";
        });
      });
    } else {
      currentProfile = {name: name, photoUrl: ""};
      alert("Profile created!");
      document.getElementById("profileBox").style.display = "none";
      document.getElementById("postBox").style.display = "block";
    }
  }

  function addPost() {
    const message = document.getElementById("postText").value.trim();
    const imageFile = document.getElementById("postImage").files[0];

    if (!message && !imageFile) { alert("Write a message or select an image"); return; }

    const postsRef = database.ref('posts');
    if (imageFile) {
      const imageRef = storage.ref('posts/' + imageFile.name);
      imageRef.put(imageFile).then(snapshot => {
        snapshot.ref.getDownloadURL().then(url => {
          postsRef.push({name: currentProfile.name, photoUrl: currentProfile.photoUrl, message: message, imageUrl: url});
          document.getElementById("postText").value = "";
          document.getElementById("postImage").value = "";
        });
      });
    } else {
      postsRef.push({name: currentProfile.name, photoUrl: currentProfile.photoUrl, message: message});
      document.getElementById("postText").value = "";
    }
  }

  const postsRef = database.ref('posts');
  postsRef.on('value', snapshot => {
    const feed = document.getElementById("feed");
    feed.innerHTML = "";
    const data = snapshot.val();
    if (data) {
      const postsArray = Object.values(data).reverse();
      postsArray.forEach(post => {
        const postDiv = document.createElement("div");
        postDiv.className = "post";
        postDiv.innerHTML = `
          <h4>${post.name}</h4>
          ${post.photoUrl ? `<img src="${post.photoUrl}" alt="Profile Picture">` : ''}
          ${post.message ? `<p>${post.message}</p>` : ''}
          ${post.imageUrl ? `<img src="${post.imageUrl}" alt="Post Image">` : ''}
        `;
        feed.appendChild(postDiv);
      });
    }
  });
</script>
</head>
<body>

<header>ZoomUnta</header>

<!-- CREATE PROFILE -->
<div class="profile-box" id="profileBox">
  <input type="text" id="profileName" placeholder="Enter your name"><br>
  <input type="file" id="profilePic" accept="image/*"><br>
  <button onclick="createProfile()">Create Profile</button>
</div>

<!-- POST BOX -->
<div class="post-box" id="postBox" style="display:none;">
  <textarea id="postText" placeholder="What's on your mind?"></textarea><br>
  <input type="file" id="postImage" accept="image/*"><br>
  <button onclick="addPost()">Post</button>
</div>

<!-- FEED -->
<div class="feed" id="feed"></div>

</body>
</html>
